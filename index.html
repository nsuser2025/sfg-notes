<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Markdown ノート表示 (修正版)</title>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']] // インライン数式を $...$ と \(...\) で有効化
      }
    };
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<style>
/* 数式やMarkdownコンテンツが見やすいように簡単なスタイルを追加 */
body { font-family: Arial, sans-serif; padding: 20px; }
</style>
</head>
<body>

<h1>Markdown ノート表示</h1>

<div id="note-container">
    <p>ノートを読み込んでいます...</p>
</div>

<script>
// Marked.js のオプション設定
marked.setOptions({
  breaks: true, // Markdownの改行をHTMLの <br> に変換
  gfm: true,    // GitHub Flavored Markdownを有効化
});

// ChatGPTが提示したコア処理
fetch('notes/chapter1.md')
  .then(res => {
        // HTTPエラー（404 Not Foundなど）をチェックし、エラーを投げる
        if (!res.ok) {
            throw new Error(`ファイルの読み込みに失敗しました: ${res.status} ${res.statusText}`);
        }
        return res.text();
    })
  .then(text => {
      const container = document.getElementById('note-container');
      // 1. MarkdownをHTMLに変換
      container.innerHTML = marked.parse(text);
      // 2. MathJaxによる数式レンダリングを実行
      MathJax.typesetPromise([container]);
  })
  .catch(err => {
    console.error('Markdown 読み込み失敗:', err);
    // ユーザー向けのわかりやすいエラー表示
    document.getElementById('note-container').innerHTML = 
        `<p style="color: red;"><strong>ノートの読み込みに失敗しました。</strong></p>
         <p>エラー詳細: ${err.message}</p>`;
  });
</script>

</body>
</html>
